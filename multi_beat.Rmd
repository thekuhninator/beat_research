
```{r}
# load in the neccessary libraries
library(ggplot2)

```



```{r}

# take in a folder as input
log_folder = "C:/Users/Roman/Documents/Work/Depression_and_Immunology/beat/log_files"
log_files <- list.files(log_folder)

comparative_boxplot_data <- NULL

for(log_file in log_files)
{
  print(log_file)
  log_file_path <- file.path(log_folder, log_file)
  con <- file(log_file_path, "r")
  magic_word    <- readLines(con, n = 1)
  # check the magic word
  dataset_name  <- readLines(con, n = 1)
  kbet_expected <- as.numeric(readLines(con, n = 1))
  kbet_observed <- as.numeric(readLines(con, n = 1))
  kbet_signif   <- as.numeric(readLines(con, n = 1))
  tsne_path     <- readLines(con, n = 1)
  pca_path      <- readLines(con, n = 1)
  
  boxplot_data <- read.csv(log_file_path, check.names=FALSE, skip = 7)
  boxplot_data['dataset'] <- dataset_name
  
  if(is.null(comparative_boxplot_data))
  {
    comparative_boxplot_data <- boxplot_data
  }
  else
  {
    comparative_boxplot_data <- rbind(comparative_boxplot_data, boxplot_data)
  }
  close(con)
  
  # one thing we can do is get the max from the boxplot data, then add that to every subsequent one so it treats each one as different... but i'm not too sure

}
# get a list of files from this folder
# iterate through the list of files
# read in the log files
print('c boxplot data')
print(head(comparative_boxplot_data))
print(tail(comparative_boxplot_data))

```

Generate combined boxplot...

dataset       batch          mean

d1             1               5.0


```{r}

grouped_boxplot <- function(boxplot_data, output_dir, output_name)
{
  # create the output file
  file_name <- paste(output_name, '_grouped_boxplot.png')
  output_file_path <- file.path(output_dir, file_name)
  png(output_file_path)
  
  # generate the plot
  g <- ggplot(comparative_boxplot_data, aes(x=dataset,
                                     y=mean,
                                     fill=as.factor(batch))) +
  geom_boxplot() +
  labs(title = "Comparative Grouped Boxplot", x ="Dataset", y = "Gene Mean Expression", fill = "Batch")
  
  # save the output file
  print(g)
  dev.off()
  
  }


```


```{r}

# let's create the HVG vs kBET acceptance rate plots... oh wait

```

